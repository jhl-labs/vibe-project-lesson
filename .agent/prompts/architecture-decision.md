# Architecture Decision Prompt

## 목적
아키텍처 결정을 분석하고 ADR(Architecture Decision Record)을 작성합니다.

## 컨텍스트
기술적 선택이 필요한 상황에서 옵션을 분석하고 결정을 문서화합니다.

---

## 프롬프트 템플릿

```
아키텍처 결정을 도와줘.

### 결정 필요 사항
[어떤 기술적 결정을 해야 하는지]

### 배경
[이 결정이 필요한 이유와 비즈니스 컨텍스트]

### 제약 조건
- [기술적 제약]
- [비용 제약]
- [시간 제약]
- [팀 역량]

### 고려 중인 옵션
1. [옵션 1]
2. [옵션 2]
3. [옵션 3]

### 평가 기준
- [기준 1: 예 - 성능]
- [기준 2: 예 - 유지보수성]
- [기준 3: 예 - 비용]

다음을 제공해줘:
1. 각 옵션의 장단점 분석
2. 옵션 비교표
3. 권장 결정 및 근거
4. ADR 문서
```

---

## 출력 형식

```markdown
## 아키텍처 결정 분석

### 옵션 분석

#### 옵션 1: [이름]
**장점:**
- ...

**단점:**
- ...

### 옵션 비교

| 기준 | 옵션 1 | 옵션 2 | 옵션 3 |
|------|--------|--------|--------|
| 성능 | ... | ... | ... |

### 권장 결정
[결정 및 근거]

---

## ADR: [제목]

### 상태
[Proposed/Accepted/Deprecated/Superseded]

### 컨텍스트
[결정이 필요한 배경]

### 결정
[선택한 옵션]

### 결과
[결정으로 인한 영향]
```

---

## 예시

### 입력
```
아키텍처 결정을 도와줘.

### 결정 필요 사항
실시간 알림 시스템의 기술 스택 선정

### 배경
사용자에게 실시간으로 알림을 전송해야 함 (주문 상태, 메시지 등)
현재 폴링 방식으로 구현되어 있으나 서버 부하가 높음

### 제약 조건
- 현재 인프라: AWS ECS, RDS
- 월 예산: $500 추가 가능
- 팀: Node.js 경험 풍부, Go 경험 없음
- 동시 접속: 최대 10,000명

### 고려 중인 옵션
1. Socket.io (자체 구축)
2. AWS AppSync (GraphQL Subscriptions)
3. Pusher (SaaS)

### 평가 기준
- 성능/확장성
- 구현 복잡도
- 비용
- 운영 부담
```

### 출력
```markdown
## 아키텍처 결정 분석

### 옵션 분석

#### 옵션 1: Socket.io (자체 구축)

**장점:**
- 완전한 제어 가능
- 초기 비용 낮음
- 팀이 Node.js에 익숙함

**단점:**
- 확장 시 복잡도 증가 (Redis Adapter 필요)
- 운영 부담 (모니터링, 장애 대응)
- sticky session 필요

**구현 복잡도:** 중상
**월 예상 비용:** $100-200 (서버 추가)

---

#### 옵션 2: AWS AppSync

**장점:**
- 서버리스, 자동 확장
- AWS 생태계 통합
- GraphQL 기반 타입 안전성

**단점:**
- 학습 곡선 (GraphQL, VTL)
- 복잡한 비즈니스 로직 구현 어려움
- 요청당 과금 (대규모 시 비용 증가)

**구현 복잡도:** 중
**월 예상 비용:** $150-400 (요청량에 따라)

---

#### 옵션 3: Pusher

**장점:**
- 가장 빠른 구현
- 검증된 안정성
- 클라이언트 SDK 우수

**단점:**
- 벤더 종속성
- 대규모 시 비용 급증
- 커스터마이징 제한

**구현 복잡도:** 낮음
**월 예상 비용:** $99 (Startup 플랜)

---

### 옵션 비교

| 기준 | Socket.io | AppSync | Pusher |
|------|-----------|---------|--------|
| 성능 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| 확장성 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| 구현 복잡도 | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 비용 (10K) | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ |
| 운영 부담 | ⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 유연성 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐ |

### 권장 결정

**옵션 3: Pusher** 권장

**근거:**
1. 빠른 구현으로 시장 출시 앞당김
2. 현재 규모(10K)에서 비용 효율적
3. 운영 부담 최소화 (팀 규모 고려)
4. 향후 규모 확대 시 Socket.io로 마이그레이션 가능

**리스크 대응:**
- 비용 임계점(2만 동접) 도달 시 자체 구축 검토
- 핵심 로직은 Pusher 비의존적으로 설계 (추상화 레이어)

---

## ADR-0001: 실시간 알림 시스템 기술 스택

### 상태
Accepted

### 컨텍스트
- 사용자에게 실시간 알림(주문 상태, 메시지)을 전송해야 함
- 현재 폴링 방식으로 서버 부하가 높음
- 예상 동시 접속: 10,000명
- 팀은 Node.js 경험이 풍부하나 운영 역량은 제한적

### 결정
Pusher를 사용하여 실시간 알림을 구현한다.

### 근거
1. **빠른 구현**: 2주 내 MVP 출시 가능
2. **검증된 안정성**: 대규모 트래픽 처리 실적
3. **운영 부담 최소화**: 관리형 서비스로 인프라 관리 불필요
4. **합리적 비용**: 현재 규모에서 월 $99

### 결과

**긍정적 영향:**
- 개발 시간 단축 (예상 2주)
- 운영팀 부담 감소
- 안정적인 서비스 품질

**부정적 영향:**
- 벤더 종속성 발생
- 대규모 확장 시 비용 증가 예상

**필요 조치:**
- 알림 서비스 추상화 레이어 설계
- 월간 비용 모니터링 대시보드 구축
- 2만 동접 도달 시 자체 구축 재검토

### 관련 문서
- [기술 스택 비교 분석](./tech-comparison.md)
- [비용 추정 스프레드시트](./cost-estimation.xlsx)
```

---

## ADR 템플릿 구조

```markdown
# ADR-[번호]: [제목]

## 상태
[Proposed | Accepted | Deprecated | Superseded by ADR-XXX]

## 컨텍스트
[결정이 필요한 배경 설명]

## 결정
[선택한 솔루션]

## 근거
[이 결정을 내린 이유]

## 결과
[이 결정으로 인한 영향 - 긍정/부정]

## 참고 자료
[관련 문서, 링크]
```
