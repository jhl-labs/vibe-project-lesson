import { Meta } from '@storybook/addon-docs/blocks';
import { Callout } from '../../components/Callout';
import { CodeBlock } from '../../components/CodeBlock';
import { TemplateFileViewer } from '../../components/TemplateFileViewer';
import { ComparisonTable } from '../../components/ComparisonTable';
import { MermaidDiagram } from '../../components/MermaidDiagram';
import { Quiz } from '../../components/Quiz';
import { ChapterNav } from '../../components/ChapterNav';
import { templateFiles } from '../../data/template-files';

<Meta title="Part 2: í”„ë¡œì íŠ¸ í…œí”Œë¦¿ êµ¬ì¡°/ì•„í‚¤í…ì²˜" />

# ì•„í‚¤í…ì²˜

> Clean Architecture ê¸°ë°˜ 4ë ˆì´ì–´ ì„¤ê³„

## ì•„í‚¤í…ì²˜ ì›ì¹™

ì´ í”„ë¡œì íŠ¸ í…œí”Œë¦¿ì€ **Clean Architecture**ë¥¼ ê¸°ë°˜ìœ¼ë¡œ 4ê°€ì§€ í•µì‹¬ ì›ì¹™ì„ ë”°ë¦…ë‹ˆë‹¤:

| ì›ì¹™ | ì„¤ëª… |
|------|------|
| **ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬** | ê° ë ˆì´ì–´/ëª¨ë“ˆì€ ëª…í™•í•œ ì±…ì„ì„ ê°€ì§ |
| **ì˜ì¡´ì„± ì—­ì „** | ê³ ìˆ˜ì¤€ ëª¨ë“ˆì´ ì €ìˆ˜ì¤€ ëª¨ë“ˆì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ |
| **ë‹¨ì¼ ì§„ì‹¤ ê³µê¸‰ì›** | ê° ë°ì´í„°ëŠ” í•˜ë‚˜ì˜ ìœ„ì¹˜ì—ì„œë§Œ ê´€ë¦¬ |
| **ì‹¤íŒ¨ë¥¼ ìœ„í•œ ì„¤ê³„** | ëª¨ë“  ì™¸ë¶€ í˜¸ì¶œì€ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŒì„ ê°€ì • |

## 4ë ˆì´ì–´ êµ¬ì¡°

<MermaidDiagram
  chart={`flowchart TB
    subgraph PL["ğŸŒ Presentation Layer"]
      REST["REST API"]
      GraphQL["GraphQL API"]
      gRPC["gRPC Service"]
    end
    subgraph AL["âš™ï¸ Application Layer"]
      UC["Use Cases"]
      AS["Application Services"]
    end
    subgraph DL["ğŸ’ Domain Layer"]
      E["Entities"]
      VO["Value Objects"]
      DS["Domain Services"]
    end
    subgraph IL["ğŸ”§ Infrastructure Layer"]
      Repo["Repository"]
      ExtAPI["External APIs"]
      MQ["Message Queue"]
      Cache["Cache"]
    end
    PL --> AL
    AL --> DL
    IL --> DL
    style PL fill:#1e3a5f,stroke:#818cf8,color:#f1f5f9
    style AL fill:#1e3a5f,stroke:#a78bfa,color:#f1f5f9
    style DL fill:#1e3a5f,stroke:#34d399,color:#f1f5f9
    style IL fill:#1e3a5f,stroke:#fbbf24,color:#f1f5f9`}
  title="Clean Architecture 4ë ˆì´ì–´"
  caption="ì˜ì¡´ì„±ì€ í•­ìƒ ì•ˆìª½(Domain)ì„ í–¥í•©ë‹ˆë‹¤. InfrastructureëŠ” Domainì— ì˜ì¡´í•©ë‹ˆë‹¤."
/>

<Callout type="important" title="ì˜ì¡´ì„± ë°©í–¥">
  ì˜ì¡´ì„±ì€ í•­ìƒ ì•ˆìª½(Domain)ì„ í–¥í•©ë‹ˆë‹¤:
  Presentation â†’ Application â†’ Domain â† Infrastructure
</Callout>

## ë ˆì´ì–´ë³„ ì±…ì„

<ComparisonTable
  title="ë ˆì´ì–´ë³„ ì—­í•  ë¹„êµ"
  headers={['í•­ëª©', 'Presentation', 'Application', 'Domain', 'Infrastructure']}
  rows={[
    { feature: 'HTTP ì²˜ë¦¬', values: ['yes', 'no', 'no', 'no'] },
    { feature: 'ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§', values: ['no', 'no', 'yes', 'no'] },
    { feature: 'ìœ ìŠ¤ì¼€ì´ìŠ¤ ì¡°í•©', values: ['no', 'yes', 'no', 'no'] },
    { feature: 'DB ì ‘ê·¼', values: ['no', 'no', 'no', 'yes'] },
    { feature: 'ì…ë ¥ ê²€ì¦', values: ['yes', 'no', 'no', 'no'] },
    { feature: 'íŠ¸ëœì­ì…˜ ê´€ë¦¬', values: ['no', 'yes', 'no', 'no'] },
    { feature: 'ì™¸ë¶€ API í˜¸ì¶œ', values: ['no', 'no', 'no', 'yes'] },
    { feature: 'ë„ë©”ì¸ ì´ë²¤íŠ¸', values: ['no', 'partial', 'yes', 'no'] },
  ]}
/>

## ë°ì´í„° íë¦„

<MermaidDiagram
  chart={`sequenceDiagram
    participant C as ğŸ–¥ï¸ Client
    participant CT as Controller
    participant UC as Use Case
    participant DS as Domain Service
    participant R as Repository
    participant DB as ğŸ’¾ Database
    C->>CT: HTTP Request
    Note right of CT: ì…ë ¥ ê²€ì¦, ì¸ì¦ í™•ì¸, DTO ë³€í™˜
    CT->>UC: Command/Query
    Note right of UC: ë¹„ì¦ˆë‹ˆìŠ¤ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜, íŠ¸ëœì­ì…˜ ê²½ê³„
    UC->>DS: ë„ë©”ì¸ ë©”ì„œë“œ í˜¸ì¶œ
    Note right of DS: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰, ê·œì¹™ ê°•ì œ
    DS->>R: ë°ì´í„° ì ‘ê·¼
    Note right of R: ë°ì´í„° ì˜ì†í™”
    R->>DB: SQL Query
    DB-->>R: Result Set
    R-->>DS: Entity
    DS-->>UC: Domain Result
    UC-->>CT: Response DTO
    CT-->>C: HTTP Response`}
  title="ìš”ì²­ ì²˜ë¦¬ ë°ì´í„° íë¦„"
  caption="í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì´ ê° ë ˆì´ì–´ë¥¼ ê±°ì³ ì²˜ë¦¬ë˜ëŠ” ê³¼ì •"
/>

## ì‹¤ì œ architecture.md íŒŒì¼

<TemplateFileViewer
  filename=".agent/architecture.md"
  content={templateFiles['.agent/architecture.md']}
  language="markdown"
  annotations={[
    { lineStart: 1, lineEnd: 24, text: 'ì•„í‚¤í…ì²˜ ì›ì¹™ ì„¹ì…˜ì…ë‹ˆë‹¤. 4ê°€ì§€ í•µì‹¬ ì›ì¹™(ê´€ì‹¬ì‚¬ ë¶„ë¦¬, ì˜ì¡´ì„± ì—­ì „, ë‹¨ì¼ ì§„ì‹¤ ê³µê¸‰ì›, ì‹¤íŒ¨ë¥¼ ìœ„í•œ ì„¤ê³„)ì„ ì •ì˜í•©ë‹ˆë‹¤.' },
    { lineStart: 26, lineEnd: 67, text: 'ë ˆì´ì–´ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ì…ë‹ˆë‹¤. ASCII ì•„íŠ¸ë¡œ Presentation, Application, Domain, Infrastructure 4ê°œ ë ˆì´ì–´ë¥¼ ì‹œê°ì ìœ¼ë¡œ í‘œí˜„í•©ë‹ˆë‹¤.' },
    { lineStart: 69, lineEnd: 97, text: 'Presentation Layer ìƒì„¸ì…ë‹ˆë‹¤. HTTP ì²˜ë¦¬, ì…ë ¥ ê²€ì¦, ì¸ì¦/ì¸ê°€, DTO ë³€í™˜ì˜ ì±…ì„ê³¼ ì½”ë“œ ì˜ˆì œë¥¼ í¬í•¨í•©ë‹ˆë‹¤.' },
    { lineStart: 99, lineEnd: 130, text: 'Application Layer ìƒì„¸ì…ë‹ˆë‹¤. ìœ ìŠ¤ì¼€ì´ìŠ¤ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜, íŠ¸ëœì­ì…˜ ê´€ë¦¬, ì´ë²¤íŠ¸ ë°œí–‰ì˜ ì—­í• ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.' },
    { lineStart: 132, lineEnd: 176, text: 'Domain Layer ìƒì„¸ì…ë‹ˆë‹¤. ì—”í„°í‹°, ê°’ ê°ì²´, ë„ë©”ì¸ ì„œë¹„ìŠ¤ì˜ êµ¬í˜„ ì˜ˆì œë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ í•µì‹¬ì…ë‹ˆë‹¤.' },
    { lineStart: 178, lineEnd: 216, text: 'Infrastructure Layer ìƒì„¸ì…ë‹ˆë‹¤. Repository êµ¬í˜„, ì™¸ë¶€ API í´ë¼ì´ì–¸íŠ¸, DB ì„¤ì • ë“± ê¸°ìˆ ì  êµ¬í˜„ì²´ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.' },
  ]}
/>

<Quiz
  title="ì•„í‚¤í…ì²˜ ì´í•´ë„ í™•ì¸"
  questions={[
    {
      question: 'Clean Architectureì—ì„œ ì˜ì¡´ì„± ë°©í–¥ì€?',
      options: ['Domain â†’ Infrastructure', 'Infrastructure â†’ Domain', 'ì™¸ë¶€ì—ì„œ ë‚´ë¶€(Domain) ë°©í–¥', 'ë‚´ë¶€ì—ì„œ ì™¸ë¶€ ë°©í–¥'],
      correctIndex: 2,
      explanation: 'Clean Architectureì—ì„œ ì˜ì¡´ì„±ì€ í•­ìƒ ì™¸ë¶€ì—ì„œ ë‚´ë¶€(Domain) ë°©í–¥ìœ¼ë¡œ í–¥í•©ë‹ˆë‹¤. Domain ë ˆì´ì–´ëŠ” ë‹¤ë¥¸ ì–´ë–¤ ë ˆì´ì–´ì—ë„ ì˜ì¡´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',
    },
    {
      question: 'ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë‹´ë‹¹í•˜ëŠ” ë ˆì´ì–´ëŠ”?',
      options: ['Presentation Layer', 'Application Layer', 'Domain Layer', 'Infrastructure Layer'],
      correctIndex: 2,
      explanation: 'Domain LayerëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìº¡ìŠí™”í•˜ê³ , ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì„ ê°•ì œí•˜ë©°, ë„ë©”ì¸ ë¶ˆë³€ì„±ì„ ìœ ì§€í•˜ëŠ” í•µì‹¬ ë ˆì´ì–´ì…ë‹ˆë‹¤.',
    },
    {
      question: 'DB ì ‘ê·¼ì„ ë‹´ë‹¹í•˜ëŠ” ë ˆì´ì–´ëŠ”?',
      options: ['Presentation Layer', 'Application Layer', 'Domain Layer', 'Infrastructure Layer'],
      correctIndex: 3,
      explanation: 'Infrastructure Layerê°€ Repository êµ¬í˜„, ì™¸ë¶€ API í´ë¼ì´ì–¸íŠ¸, DB ì„¤ì • ë“± ê¸°ìˆ ì  êµ¬í˜„ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.',
    },
  ]}
/>

<ChapterNav
  prev={{ title: 'ì»¨í…ìŠ¤íŠ¸ì™€ ì»¨ë²¤ì…˜', path: '/docs/part-2--í”„ë¡œì íŠ¸-í…œí”Œë¦¿-êµ¬ì¡°-ì»¨í…ìŠ¤íŠ¸ì™€-ì»¨ë²¤ì…˜' }}
  next={{ title: 'ê°€ì´ë“œë¼ì¸', path: '/docs/part-2--í”„ë¡œì íŠ¸-í…œí”Œë¦¿-êµ¬ì¡°-ê°€ì´ë“œë¼ì¸' }}
/>
