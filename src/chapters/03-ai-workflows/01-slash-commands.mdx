import { Meta } from '@storybook/blocks';
import { Callout } from '../../components/Callout';
import { CodeBlock } from '../../components/CodeBlock';
import { TemplateFileViewer } from '../../components/TemplateFileViewer';
import { ComparisonTable } from '../../components/ComparisonTable';
import { Quiz } from '../../components/Quiz';
import { ChapterNav } from '../../components/ChapterNav';
import { templateFiles } from '../../data/template-files';

<Meta title="Part 3: AI Agent 워크플로우/슬래시 커맨드" />

# 슬래시 커맨드

> AI 에이전트에게 특정 작업을 빠르게 요청하는 단축 명령어

## 개요

슬래시 커맨드는 AI 에이전트에서 자주 사용하는 작업을 **일관된 형식**으로 빠르게 실행하는 단축 명령어입니다.

### 내장 커맨드 vs 커스텀 커맨드

<ComparisonTable
  title="커맨드 유형 비교"
  headers={['항목', '내장 커맨드', '커스텀 커맨드']}
  rows={[
    { feature: '제공 주체', values: ['Claude Code 기본', '프로젝트 정의'] },
    { feature: '설정 파일', values: ['없음 (내장)', '.agent/commands.md'] },
    { feature: '커스터마이징', values: ['no', 'yes'] },
    { feature: '예시', values: ['/init, /clear, /help', '/commit, /pr, /review'] },
  ]}
/>

## 내장 슬래시 커맨드

| 커맨드 | 설명 |
|--------|------|
| `/init` | CLAUDE.md 자동 생성 |
| `/clear` | 대화 기록 초기화 |
| `/help` | 도움말 표시 |
| `/compact` | 컨텍스트 압축 |
| `/cost` | 토큰 사용량 확인 |
| `/doctor` | 설치 상태 진단 |
| `/login` | 로그인 |
| `/logout` | 로그아웃 |

## 커스텀 슬래시 커맨드 (10개)

이 프로젝트 템플릿에서 정의한 10개의 커스텀 커맨드입니다:

### 개발 워크플로우 커맨드

| 커맨드 | 설명 | 출력물 |
|--------|------|--------|
| `/commit` | 커밋 메시지 생성 | Conventional Commit 형식 메시지 |
| `/pr` | PR 설명 생성 | PR 제목, 설명, 체크리스트 |
| `/changelog` | 변경 이력 업데이트 | CHANGELOG 엔트리 |
| `/hotfix` | 긴급 패치 가이드 | 핫픽스 워크플로우 |
| `/migrate` | 마이그레이션 스크립트 | DB/스키마 마이그레이션 |

### 코드 품질 커맨드

| 커맨드 | 설명 | 출력물 |
|--------|------|--------|
| `/review` | 코드 리뷰 | 리뷰 코멘트 및 제안 |
| `/test` | 테스트 케이스 생성 | 단위 테스트 코드 |
| `/refactor` | 리팩토링 제안 | 개선된 코드 및 설명 |
| `/security` | 보안 스캔 | 취약점 리포트 |
| `/doc` | 문서 생성 | API 문서, JSDoc 등 |

### /commit 커맨드 상세

<CodeBlock
  code={`# 사용법
/commit

# 출력 예시
feat(auth): add JWT refresh token support

- Implement refresh token rotation
- Add token blacklist for logout
- Update auth middleware to handle refresh

Closes #123`}
  language="bash"
  filename="/commit 사용 예시"
/>

### /review 커맨드 상세

<CodeBlock
  code={`# 사용법
/review
/review src/services/user.ts
/review --focus security

# 출력 예시
## 코드 리뷰 결과

### 요약
- 변경 파일: 3개
- 발견된 이슈: 2개

### 필수 수정 (Blocker)
🚨 [src/api/users.ts:45] SQL 인젝션 취약점 발견

### 권장 사항 (Suggestion)
💡 [src/services/user.ts:23] 에러 처리 개선 필요`}
  language="markdown"
  filename="/review 출력 예시"
/>

### /security 커맨드 상세

<CodeBlock
  code={`# 사용법
/security
/security src/api/

# 출력 예시
## 보안 스캔 결과

### 요약
- 스캔 범위: src/
- 🔴 Critical: 1개
- 🟠 High: 2개
- 🟡 Medium: 3개

### 상세
#### 🔴 SQL Injection
- 위치: src/api/users.ts:45
- 설명: 사용자 입력이 쿼리에 직접 사용됨
- 수정 권고: 파라미터화된 쿼리 사용`}
  language="markdown"
  filename="/security 출력 예시"
/>

## 커맨드 조합 워크플로우

<CodeBlock
  code={`# 일반적인 개발 워크플로우
/review → /test → /commit → /pr

# 보안 중심 워크플로우
/security → /review --focus security → /commit

# 문서 중심 워크플로우
/doc → /changelog → /commit`}
  language="bash"
  filename="커맨드 조합"
/>

## 실제 commands.md 파일

<TemplateFileViewer
  filename=".agent/commands.md"
  content={templateFiles['.agent/commands.md']}
  language="markdown"
  annotations={[
    { lineStart: 1, lineEnd: 23, text: '커맨드 개요와 전체 목록 테이블입니다. 10개의 커스텀 슬래시 커맨드와 각각의 설명, 결과물을 한눈에 볼 수 있습니다.' },
    { lineStart: 28, lineEnd: 69, text: '/commit 커맨드 상세입니다. Conventional Commits 형식을 따르며 타입 선택 기준도 정의합니다.' },
    { lineStart: 118, lineEnd: 155, text: '/review 커맨드 상세입니다. Blocker/Suggestion/Question/Praise 4단계로 분류된 리뷰 결과를 생성합니다.' },
    { lineStart: 261, lineEnd: 294, text: '/security 커맨드 상세입니다. Critical/High/Medium 심각도로 분류된 보안 취약점 리포트를 생성합니다.' },
    { lineStart: 401, lineEnd: 440, text: '커맨드 조합과 커스터마이징 방법, 그리고 대응하는 프롬프트/스킬 파일 매핑을 보여줍니다.' },
  ]}
/>

<Callout type="tip" title="커스터마이징">
  팀의 워크플로우에 맞게 commands.md를 수정하고, skills/ 디렉토리의 해당 스킬 파일도 함께 조정하세요.
</Callout>

<Quiz
  title="슬래시 커맨드 이해도 확인"
  questions={[
    {
      question: '/commit 커맨드가 따르는 메시지 형식은?',
      options: ['자유 형식', 'Conventional Commits', 'Semantic Versioning', 'Angular Commit'],
      correctIndex: 1,
      explanation: '/commit은 Conventional Commits 형식(feat/fix/docs 등의 타입 + 스코프 + 설명)을 따르는 커밋 메시지를 생성합니다.',
    },
    {
      question: '코드 보안 취약점을 분석하는 커맨드는?',
      options: ['/review', '/test', '/security', '/refactor'],
      correctIndex: 2,
      explanation: '/security 커맨드는 OWASP Top 10을 기반으로 코드의 보안 취약점을 분석하고 Critical/High/Medium 심각도로 분류된 리포트를 생성합니다.',
    },
  ]}
/>

<ChapterNav
  prev={{ title: '가이드라인', path: '/docs/part-2--프로젝트-템플릿-구조-가이드라인' }}
  next={{ title: '프롬프트 라이브러리', path: '/docs/part-3--ai-agent-워크플로우-프롬프트-라이브러리' }}
/>
