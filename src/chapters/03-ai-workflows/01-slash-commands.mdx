import { Meta } from '@storybook/addon-docs/blocks';
import { Callout } from '../../components/Callout';
import { CodeBlock } from '../../components/CodeBlock';
import { TemplateFileViewer } from '../../components/TemplateFileViewer';
import { ComparisonTable } from '../../components/ComparisonTable';
import { MermaidDiagram } from '../../components/MermaidDiagram';
import { ChapterNav } from '../../components/ChapterNav';
import { templateFiles } from '../../data/template-files';

<Meta title="Part 3: AI Agent 워크플로우/슬래시 커맨드" />

# 슬래시 커맨드

> AI 에이전트에게 특정 작업을 빠르게 요청하는 단축 명령어

## 개요

슬래시 커맨드는 AI 에이전트에서 자주 사용하는 작업을 **일관된 형식**으로 빠르게 실행하는 단축 명령어입니다.

### 내장 커맨드 vs 커스텀 커맨드

<ComparisonTable
  title="커맨드 유형 비교"
  headers={['항목', '내장 커맨드', '커스텀 커맨드']}
  rows={[
    { feature: '제공 주체', values: ['Claude Code 기본', '프로젝트 정의'] },
    { feature: '설정 파일', values: ['없음 (내장)', '.claude/commands/*.md'] },
    { feature: '커스터마이징', values: ['no', 'yes'] },
    { feature: '예시', values: ['/init, /clear, /help', '/commit, /pr, /review'] },
  ]}
/>

## 내장 커맨드 — Claude Code 기본 제공

아래는 Claude Code에 **기본 내장**된 커맨드입니다. 별도 설정 없이 모든 프로젝트에서 바로 사용할 수 있습니다. Claude Code는 지속적으로 업데이트되므로, `/help`를 실행하면 현재 버전의 전체 커맨드 목록을 확인할 수 있습니다.

### 세션/컨텍스트 관리

| 커맨드 | 설명 |
|--------|------|
| `/help` | 전체 커맨드 목록 및 도움말 표시 |
| `/init` | CLAUDE.md 자동 생성 |
| `/clear` | 대화 기록 초기화 |
| `/compact` | 컨텍스트 압축 (긴 세션에서 메모리 효율화) |
| `/cost` | 현재 세션의 토큰 사용량 및 비용 확인 |
| `/status` | 현재 git 상태 및 세션 정보 확인 |
| `/model` | 사용할 AI 모델 변경 |
| `/login` | 로그인 |
| `/logout` | 로그아웃 |

### 설정/환경

| 커맨드 | 설명 |
|--------|------|
| `/config` | Claude Code 설정 관리 |
| `/permissions` | 권한 규칙 확인 및 관리 |
| `/memory` | 시스템 에디터에서 CLAUDE.md 직접 편집 |
| `/mcp` | MCP 서버 상태 확인 및 관리 |
| `/hooks` | Hook 설정을 인터랙티브하게 관리 |
| `/doctor` | 설치 상태 진단 |
| `/vim` | Vim 키 바인딩 모드 전환 |
| `/terminal-setup` | 터미널 통합 설정 |
| `/install-github-app` | GitHub App 설치 (PR 자동 리뷰 등) |

### 개발 지원

| 커맨드 | 설명 |
|--------|------|
| `/review` | 코드 리뷰 (내장) |
| `/bug` | 버그 리포트 제출 |

---

## 커스텀 커맨드 — 이 프로젝트 템플릿 정의 (10개)

아래 10개 커맨드는 Claude Code 내장이 **아닙니다**. 이 프로젝트 템플릿의 `.claude/commands/` 디렉토리에 마크다운 파일로 정의된 **프로젝트 전용 커스텀 커맨드**입니다. 팀의 워크플로우에 맞게 자유롭게 수정·추가할 수 있습니다.

<Callout type="warning" title="커스텀 커맨드는 프로젝트마다 다릅니다">
  아래 커맨드들은 이 템플릿이 제공하는 예시입니다. `.claude/commands/커맨드명.md` 파일이 있어야 동작하며,
  다른 프로젝트에서는 해당 파일이 없으면 사용할 수 없습니다.
</Callout>

### 개발 워크플로우

| 커맨드 | 설명 | 출력물 | 설정 파일 |
|--------|------|--------|-----------|
| `/commit` | 커밋 메시지 생성 | Conventional Commit 형식 메시지 | `.claude/commands/commit.md` |
| `/pr` | PR 설명 생성 | PR 제목, 설명, 체크리스트 | `.claude/commands/pr.md` |
| `/changelog` | 변경 이력 업데이트 | CHANGELOG 엔트리 | `.claude/commands/changelog.md` |
| `/hotfix` | 긴급 패치 가이드 | 핫픽스 워크플로우 | `.claude/commands/hotfix.md` |
| `/migrate` | 마이그레이션 스크립트 | DB/스키마 마이그레이션 | `.claude/commands/migrate.md` |

### 코드 품질

| 커맨드 | 설명 | 출력물 | 설정 파일 |
|--------|------|--------|-----------|
| `/review` | 코드 리뷰 (내장 확장) | 리뷰 코멘트 및 제안 | `.claude/commands/review.md` |
| `/test` | 테스트 케이스 생성 | 단위 테스트 코드 | `.claude/commands/test.md` |
| `/refactor` | 리팩토링 제안 | 개선된 코드 및 설명 | `.claude/commands/refactor.md` |
| `/security` | 보안 스캔 | 취약점 리포트 | `.claude/commands/security.md` |
| `/doc` | 문서 생성 | API 문서, JSDoc 등 | `.claude/commands/doc.md` |

<Callout type="info" title="커스텀 /review vs 내장 /review">
  Claude Code에는 내장 `/review`가 있지만, `.claude/commands/review.md`로 동일 이름의 커스텀 커맨드를 정의하면
  **커스텀 버전이 우선 실행**됩니다. 프로젝트별 리뷰 기준(보안 체크리스트, 컨벤션 검증 등)을 반영할 수 있습니다.
</Callout>

### [커스텀] /commit 상세

스테이징된 변경사항을 분석하여 Conventional Commits 형식의 커밋 메시지를 생성합니다.

<CodeBlock
  code={`# 사용법
/commit

# 출력 형식
<type>(<scope>): <subject>

<body>

<footer>

# 출력 예시
feat(auth): add JWT refresh token support

- Implement refresh token rotation
- Add token blacklist for logout
- Update auth middleware to handle refresh

Closes #123`}
  language="bash"
  filename="/commit 사용 예시"
/>

**타입 선택 기준:**

| 타입 | 사용 시점 |
|------|----------|
| `feat` | 새로운 기능 추가 |
| `fix` | 버그 수정 |
| `docs` | 문서만 변경 |
| `style` | 코드 포맷팅 (기능 변화 없음) |
| `refactor` | 기능 변화 없는 코드 개선 |
| `test` | 테스트 추가/수정 |
| `chore` | 빌드/설정 변경 |
| `perf` | 성능 개선 |
| `security` | 보안 관련 변경 |

### [커스텀] /pr 상세

브랜치의 변경사항을 분석하여 PR 제목과 설명을 생성합니다.

<CodeBlock
  code={`# 사용법
/pr
/pr --base main
/pr --template detailed

# 출력 예시
## PR 제목
feat: JWT 리프레시 토큰 지원

## 요약
변경사항 요약 (2-3문장)

## 변경 상세
### 추가된 것
- 리프레시 토큰 로테이션 구현
- 토큰 블랙리스트 추가

### 변경된 것
- 인증 미들웨어 업데이트

### 제거된 것
- 레거시 토큰 검증 로직

## 관련 이슈
Closes #123

## 테스트
- [ ] 단위 테스트 추가
- [ ] 통합 테스트 확인
- [ ] 수동 테스트 완료

## 체크리스트
- [ ] 자체 코드 리뷰 완료
- [ ] 문서 업데이트
- [ ] 린트 통과`}
  language="markdown"
  filename="/pr 출력 예시"
/>

### [커스텀] /review 상세

지정된 코드 또는 현재 변경사항에 대한 코드 리뷰를 수행합니다. Blocker/Suggestion/Question/Praise 4단계로 분류된 피드백을 생성합니다.

<CodeBlock
  code={`# 사용법
/review
/review src/services/user.ts
/review --focus security

# 출력 예시
## 코드 리뷰 결과

### 요약
- 변경 파일: 3개
- 발견된 이슈: 2개

### 필수 수정 (Blocker)
🚨 [src/api/users.ts:45] SQL 인젝션 취약점 발견

### 권장 사항 (Suggestion)
💡 [src/services/user.ts:23] 에러 처리 개선 필요

### 질문 (Question)
❓ [src/services/user.ts:50] 이 로직의 의도가 무엇인가요?

### 좋은 점 (Praise)
✨ 에러 핸들링이 일관적으로 잘 구현되어 있습니다

### 결론
수정 요청 (Blocker 해결 필요)`}
  language="markdown"
  filename="/review 출력 예시"
/>

### [커스텀] /test 상세

지정된 코드에 대한 테스트 케이스를 생성합니다. 단위, 통합, E2E 테스트를 지원합니다.

<CodeBlock
  code={`# 사용법
/test src/services/user.ts
/test --type unit
/test --type integration
/test --coverage 80

# 출력 예시
describe('UserService', () => {
  describe('createUser', () => {
    it('should create a user with valid data', async () => {
      // Arrange
      const userData = { email: 'test@example.com', name: 'Test' };

      // Act
      const result = await userService.createUser(userData);

      // Assert
      expect(result.email).toBe('test@example.com');
      expect(result.id).toBeDefined();
    });

    it('should throw ValidationError for invalid email', async () => {
      const userData = { email: 'invalid', name: 'Test' };
      await expect(userService.createUser(userData))
        .rejects.toThrow(ValidationError);
    });
  });
});`}
  language="typescript"
  filename="/test 출력 예시"
/>

### [커스텀] /doc 상세

코드에 대한 문서를 생성합니다. JSDoc, API 문서, README 등 다양한 형식을 지원합니다.

<CodeBlock
  code={`# 사용법
/doc src/services/user.ts
/doc --type jsdoc
/doc --type api
/doc --type readme

# 출력 예시 (JSDoc)
/**
 * Creates a new user account.
 *
 * @param data - User creation data
 * @returns Created user object
 * @throws {ValidationError} When email is invalid
 *
 * @example
 * const user = await createUser({
 *   email: 'user@example.com',
 *   name: 'John'
 * });
 */`}
  language="typescript"
  filename="/doc 출력 예시"
/>

### [커스텀] /refactor 상세

코드 스멜을 탐지하고 리팩토링을 제안합니다. 성능, 가독성 등 포커스를 지정할 수 있습니다.

<CodeBlock
  code={`# 사용법
/refactor src/services/order.ts
/refactor --focus performance
/refactor --focus readability

# 출력 예시
## 리팩토링 제안

### 대상
- 파일: src/services/order.ts
- 함수: processOrder

### 발견된 코드 스멜
1. Long Method (75줄)
2. Complex Conditional (5단계 중첩)

### 제안

#### Step 1: Extract Function
// Before
function processOrder(order) {
  // ... 75줄의 복잡한 로직 ...
}

// After
function processOrder(order) {
  validateOrder(order);
  const pricing = calculatePricing(order);
  return finalizeOrder(order, pricing);
}

### 예상 효과
- 가독성 향상
- 테스트 용이성 개선`}
  language="markdown"
  filename="/refactor 출력 예시"
/>

### [커스텀] /security 상세

코드의 보안 취약점을 분석합니다. Critical/High/Medium 심각도로 분류된 리포트를 생성합니다.

<CodeBlock
  code={`# 사용법
/security
/security src/api/
/security --severity high

# 출력 예시
## 보안 스캔 결과

### 요약
- 스캔 범위: src/
- 🔴 Critical: 1개
- 🟠 High: 2개
- 🟡 Medium: 3개

### 상세
#### 🔴 SQL Injection
- 위치: src/api/users.ts:45
- 설명: 사용자 입력이 쿼리에 직접 사용됨
- 수정 권고: 파라미터화된 쿼리 사용

### 권장 조치
1. Critical/High 즉시 수정
2. Medium 1주일 내 수정`}
  language="markdown"
  filename="/security 출력 예시"
/>

### [커스텀] /changelog 상세

최근 변경사항을 분석하여 CHANGELOG 엔트리를 생성합니다. Keep a Changelog 형식을 따릅니다.

<CodeBlock
  code={`# 사용법
/changelog
/changelog --version 1.2.0
/changelog --since v1.1.0

# 출력 예시
## [1.2.0] - 2024-01-15

### Added
- JWT 리프레시 토큰 지원 (#123)
- 사용자 프로필 API (#124)

### Changed
- 로그인 플로우 개선 (#125)

### Fixed
- 세션 만료 버그 수정 (#126)

### Security
- XSS 취약점 패치 (#127)`}
  language="markdown"
  filename="/changelog 출력 예시"
/>

### [커스텀] /migrate 상세

데이터베이스 또는 스키마 마이그레이션 스크립트를 생성합니다. SQL, Prisma 등 다양한 형식을 지원합니다.

<CodeBlock
  code={`# 사용법
/migrate add-user-role-column
/migrate --type sql
/migrate --type prisma

# 출력 예시 (SQL)
-- Migration: add_user_role_column
-- Created at: 2024-01-15

-- Up
ALTER TABLE users ADD COLUMN role VARCHAR(50) DEFAULT 'user';
CREATE INDEX idx_users_role ON users(role);

-- Down
DROP INDEX idx_users_role;
ALTER TABLE users DROP COLUMN role;`}
  language="sql"
  filename="/migrate 출력 예시"
/>

### [커스텀] /hotfix 상세

긴급 수정이 필요한 상황에서 브랜치 생성부터 배포, 모니터링까지의 전체 핫픽스 워크플로우를 안내합니다.

<CodeBlock
  code={`# 사용법
/hotfix
/hotfix --issue 123

# 출력 예시
## 핫픽스 워크플로우

### 1. 브랜치 생성
git checkout main
git pull origin main
git checkout -b hotfix/ISSUE-123-critical-bug

### 2. 수정 및 테스트
- [ ] 버그 수정
- [ ] 단위 테스트 추가
- [ ] 로컬 테스트

### 3. 배포
git add .
git commit -m "fix: critical bug description"
git push origin hotfix/ISSUE-123-critical-bug

### 4. PR 생성
- base: main
- 리뷰어: @security-team
- 라벨: hotfix, urgent

### 5. 배포 후
- [ ] 프로덕션 모니터링
- [ ] 근본 원인 분석
- [ ] develop 브랜치에 백포트`}
  language="markdown"
  filename="/hotfix 출력 예시"
/>

## 커스텀 커맨드 조합 워크플로우

<MermaidDiagram
  chart={`flowchart LR
    subgraph DEV["🔧 일반 개발"]
      R1["/review"] --> T1["/test"] --> C1["/commit"] --> P1["/pr"]
    end
    subgraph SEC["🔒 보안 중심"]
      S2["/security"] --> R2["/review<br/>--focus security"] --> C2["/commit"]
    end
    subgraph DOC["📝 문서 중심"]
      D3["/doc"] --> CL3["/changelog"] --> C3["/commit"]
    end
    style DEV fill:#fdf2ee,stroke:#da7756,color:#2d2a26
    style SEC fill:#fdf2ee,stroke:#dc2626,color:#2d2a26
    style DOC fill:#fdf2ee,stroke:#16a34a,color:#2d2a26`}
  title="커맨드 조합 워크플로우"
  caption="상황에 따라 다른 커맨드 조합으로 효율적인 워크플로우를 구성합니다"
  maxWidth="680px"
/>

<Callout type="tip" title="커스터마이징">
  팀의 워크플로우에 맞게 `.claude/commands/` 디렉토리의 커맨드 파일을 수정하고,
  `.claude/skills/` 디렉토리의 해당 스킬 파일도 함께 조정하세요.
</Callout>

<Callout type="info" title="Claude Code v2.1+ 커맨드/스킬 통합 (2026.01 출시)">
  Claude Code v2.1부터 `.claude/commands/`와 `.claude/skills/` 디렉토리가 통합되었습니다.
  마크다운 파일을 `.claude/commands/` 디렉토리에 두면 `/파일명`으로 호출할 수 있습니다.
  `$ARGUMENTS` 변수로 인자를 받을 수 있고, `context: fork` 프론트매터로 독립된 서브에이전트로 실행할 수 있습니다.
  인덱스 접근도 가능합니다: `$ARGUMENTS[0]` (첫 번째 인자), `$0`, `$1` 등의 축약형도 지원됩니다.
</Callout>

<ChapterNav
  prev={{ title: '가이드라인', path: '/docs/part-2--프로젝트-템플릿-구조-가이드라인' }}
  next={{ title: '프롬프트 라이브러리', path: '/docs/part-3--ai-agent-워크플로우-프롬프트-라이브러리' }}
/>
