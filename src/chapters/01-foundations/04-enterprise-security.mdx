import { Meta } from '@storybook/addon-docs/blocks';
import { Callout } from '../../components/Callout';
import { CodeBlock } from '../../components/CodeBlock';
import { ComparisonTable } from '../../components/ComparisonTable';
import { FileTree } from '../../components/FileTree';
import { ChapterNav } from '../../components/ChapterNav';

<Meta title="Part 1: 기초/엔터프라이즈 보안" />

# 엔터프라이즈 보안 설정

> Claude Code를 기업 환경에서 안전하게 운영하기 위한 필수 설정 가이드

## 왜 엔터프라이즈 보안 설정이 필요한가?

Claude Code는 파일 시스템 접근, 명령어 실행, 외부 네트워크 통신 등 강력한 권한을 가진 AI 에이전트입니다. 개인 프로젝트에서는 기본 설정으로 충분하지만, 기업 환경에서는 **데이터 유출 방지, 권한 통제, 감사 로깅, 네트워크 제어** 등 추가적인 보안 조치가 필수적입니다.

<Callout type="warning" title="엔터프라이즈 도입 전 필수 확인">
  Claude Code를 조직에 배포하기 전에 반드시 아래 항목을 설정하세요:
  1. AI 학습 데이터 사용 차단 확인
  2. 텔레메트리 수집 정책 결정
  3. Managed Settings 배포
  4. 권한 정책 (allow/deny) 수립
  5. 감사 로깅 구성
</Callout>

## 데이터 프라이버시 — AI 학습 차단

가장 먼저 확인해야 할 것은 **회사 코드가 AI 모델 학습에 사용되지 않는지** 여부입니다.

<ComparisonTable
  title="계정 유형별 학습 데이터 정책"
  headers={['계정 유형', '학습 사용 여부', '데이터 보존 기간', '비고']}
  rows={[
    { feature: 'Free / Pro / Max', values: ['Model Improvement 설정 시 사용', '학습 허용 시 5년 / 거부 시 30일', '설정에서 토글 제어'] },
    { feature: 'Team / Enterprise', values: ['no', '30일', '기본적으로 학습에 사용 안 됨'] },
    { feature: 'API 사용자', values: ['no', '30일', '기본적으로 학습에 사용 안 됨'] },
    { feature: 'Bedrock / Vertex', values: ['no', '클라우드 제공자 정책', 'Anthropic 서버 미경유'] },
  ]}
/>

<Callout type="important" title="Team/Enterprise 계정은 기본 안전">
  Team, Enterprise, API 계정은 기본적으로 학습에 사용되지 않습니다. Development Partner Program에 명시적으로 옵트인하지 않는 한, 회사 코드는 모델 학습에 활용되지 않습니다.
</Callout>

### 개인 계정 (Pro/Max)에서 옵트아웃

개인 Pro/Max 구독으로 Claude Code를 사용하는 경우:

<CodeBlock
  code={`# 1. claude.ai/settings/data-privacy-controls 접속
# 2. "Help improve Claude" 토글 OFF
# 3. 변경 후 데이터 보존 기간이 5년 → 30일로 단축됨`}
  language="bash"
  filename="학습 옵트아웃 방법"
/>

### Zero Data Retention (ZDR)

**Zero Data Retention** 모드를 활성화하면 Anthropic 서버에 대화 내용이 전혀 보존되지 않습니다. 적절히 구성된 API 키로 사용 가능하며, Enterprise 플랜에서 활용됩니다.

## 텔레메트리 수집 차단

Claude Code는 기본적으로 사용 통계(Statsig)와 에러 리포팅(Sentry)을 수집합니다. 기업 환경에서는 이를 차단해야 할 수 있습니다.

<CodeBlock
  code={`# 모든 비필수 외부 트래픽을 한번에 비활성화 (권장)
export CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC=1

# 개별 제어가 필요한 경우
export DISABLE_TELEMETRY=1           # Statsig 사용 통계 비활성화
export DISABLE_ERROR_REPORTING=1      # Sentry 에러 리포팅 비활성화
export DISABLE_BUG_COMMAND=1          # /bug 명령어 비활성화`}
  language="bash"
  filename="텔레메트리 비활성화 환경 변수"
/>

<ComparisonTable
  title="API 제공자별 텔레메트리 기본 설정"
  headers={['수집 항목', 'Claude API (직접)', 'AWS Bedrock', 'Google Vertex']}
  rows={[
    { feature: 'Statsig (사용 통계)', values: ['기본 ON', 'no', 'no'] },
    { feature: 'Sentry (에러 리포팅)', values: ['기본 ON', 'no', 'no'] },
    { feature: '/bug 리포트', values: ['기본 ON', 'no', 'no'] },
  ]}
/>

<Callout type="info" title="Bedrock/Vertex는 기본 안전">
  AWS Bedrock 또는 Google Vertex를 통해 Claude Code를 사용하면 모든 비필수 외부 트래픽이 기본적으로 비활성화됩니다. 별도 설정이 필요 없습니다.
</Callout>

## Managed Settings — 조직 전체 정책 배포

**Managed Settings**는 조직의 IT 관리자가 모든 개발자의 Claude Code에 **강제 적용**하는 정책 파일입니다. 개별 사용자가 이 설정을 무시할 수 없습니다.

### 설정 파일 위치

<ComparisonTable
  title="설정 파일 계층 (위에서 아래로 우선순위)"
  headers={['유형', '경로', '우선순위']}
  rows={[
    { feature: 'Managed Settings (최고)', values: ['macOS: /Library/Application Support/ClaudeCode/managed-settings.json\nLinux: /etc/claude-code/managed-settings.json\nWindows: C:\\Program Files\\ClaudeCode\\managed-settings.json', '1 (최고)'] },
    { feature: 'CLI 인자', values: ['명령줄에서 직접 전달', '2'] },
    { feature: 'Local Project', values: ['.claude/settings.local.json', '3'] },
    { feature: 'Shared Project', values: ['.claude/settings.json', '4'] },
    { feature: 'User Settings', values: ['~/.claude/settings.json', '5 (최저)'] },
  ]}
/>

<Callout type="important" title="Managed Settings는 최고 우선순위">
  Managed Settings에 정의된 규칙은 다른 모든 설정을 오버라이드합니다. 사용자가 개인 settings.json에서 변경해도 Managed Settings의 규칙이 항상 우선 적용됩니다.
</Callout>

### 종합 엔터프라이즈 설정 예시

<CodeBlock
  code={`{
  "permissions": {
    "defaultMode": "default",
    "disableBypassPermissionsMode": "disable",
    "allow": [
      "Bash(npm run lint)",
      "Bash(npm run test *)",
      "Bash(npm run build)",
      "Bash(git status)",
      "Bash(git diff *)",
      "Bash(git log *)"
    ],
    "deny": [
      "Bash(curl *)",
      "Bash(wget *)",
      "Bash(sudo *)",
      "Bash(ssh *)",
      "Bash(rm -rf *)",
      "Read(./.env)",
      "Read(./.env.*)",
      "Read(./secrets/**)",
      "Edit(.env)",
      "WebFetch"
    ]
  },
  "env": {
    "CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC": "1",
    "CLAUDE_CODE_ENABLE_TELEMETRY": "1",
    "OTEL_METRICS_EXPORTER": "otlp",
    "OTEL_LOGS_EXPORTER": "otlp",
    "OTEL_EXPORTER_OTLP_ENDPOINT": "http://collector.company.com:4317"
  },
  "allowManagedHooksOnly": true,
  "allowedMcpServers": [
    { "serverName": "github" },
    { "serverName": "memory" }
  ],
  "deniedMcpServers": [
    { "serverName": "filesystem" }
  ]
}`}
  language="json"
  filename="managed-settings.json (엔터프라이즈 예시)"
/>

## 권한 제어 — Allowlist / Denylist

Claude Code의 모든 도구 사용은 **권한 규칙**으로 제어할 수 있습니다. 규칙 평가 순서는 **Deny > Ask > Allow**로, Deny가 항상 최우선입니다.

### 권한 모드

<ComparisonTable
  title="Claude Code 권한 모드"
  headers={['모드', '설명', '권장 환경']}
  rows={[
    { feature: 'default', values: ['도구 첫 사용 시 사용자에게 승인 요청', '일반 개발'] },
    { feature: 'acceptEdits', values: ['파일 편집은 자동 승인, 명령어 실행은 승인 필요', '신뢰할 수 있는 프로젝트'] },
    { feature: 'plan', values: ['분석만 가능, 파일 수정이나 명령어 실행 불가', '코드 리뷰, 감사'] },
    { feature: 'dontAsk', values: ['사전 승인된 도구만 허용, 나머지 자동 거부', 'CI/CD 파이프라인'] },
    { feature: 'bypassPermissions', values: ['모든 권한 프롬프트 건너뜀 (매우 위험)', '격리된 샌드박스 환경에서만'] },
  ]}
/>

<Callout type="warning" title="bypassPermissions 비활성화 필수">
  엔터프라이즈 환경에서는 반드시 `disableBypassPermissionsMode: "disable"`을 Managed Settings에 설정하세요. 이렇게 하면 개발자가 bypassPermissions 모드로 전환할 수 없습니다.
</Callout>

### 권한 규칙 문법

<CodeBlock
  code={`{
  "permissions": {
    "allow": [
      "Bash(npm run build)",          // 정확한 명령어
      "Bash(npm run test *)",         // npm run test로 시작하는 모든 명령어
      "Bash(* --version)",            // --version으로 끝나는 모든 명령어
      "Bash(git * main)",             // git ... main 패턴
      "Read(./src/**/*.ts)"           // src 하위 모든 .ts 파일 읽기
    ],
    "deny": [
      "Bash(curl *)",                 // 외부 요청 차단
      "Bash(wget *)",                 // 외부 다운로드 차단
      "Bash(sudo *)",                 // 관리자 권한 차단
      "Bash(rm -rf *)",              // 위험한 삭제 차단
      "Read(./.env)",                 // 환경 변수 파일 읽기 차단
      "Read(./.env.*)",               // .env.* 패턴 차단
      "Read(./secrets/**)",           // secrets 디렉토리 차단
      "Edit(.env)",                   // 환경 변수 파일 수정 차단
      "WebFetch",                     // 모든 외부 웹 요청 차단
      "WebFetch(domain:evil.com)"     // 특정 도메인만 차단
    ],
    "ask": [
      "Bash(git push *)"             // push는 항상 확인
    ]
  }
}`}
  language="json"
  filename="권한 규칙 문법 예시"
/>

### 경로 패턴

<ComparisonTable
  title="Read/Edit 경로 패턴 (gitignore 규격)"
  headers={['패턴', '의미', '예시']}
  rows={[
    { feature: '//path', values: ['파일시스템 루트 절대 경로', 'Read(//Users/alice/secrets/**)'] },
    { feature: '~/path', values: ['홈 디렉토리 기준', 'Read(~/Documents/*.pdf)'] },
    { feature: '/path', values: ['설정 파일 위치 기준 상대 경로', 'Edit(/src/**/*.ts)'] },
    { feature: 'path 또는 ./path', values: ['현재 작업 디렉토리 기준', 'Read(*.env)'] },
  ]}
/>

### MCP 서버 제어

외부 도구 연동에 사용되는 MCP 서버도 허용/차단 목록으로 관리할 수 있습니다.

<CodeBlock
  code={`{
  "allowedMcpServers": [
    { "serverName": "github" },
    { "serverName": "memory" }
  ],
  "deniedMcpServers": [
    { "serverName": "filesystem" }
  ]
}`}
  language="json"
  filename="MCP 서버 허용/차단 설정"
/>

### 서브에이전트 제어

Claude Code의 서브에이전트(Task)도 deny 규칙으로 차단할 수 있습니다.

<CodeBlock
  code={`{
  "permissions": {
    "deny": [
      "Task(Explore)",
      "Task(Plan)",
      "Task(Verify)"
    ]
  }
}`}
  language="json"
  filename="서브에이전트 차단 예시"
/>

## 인증 및 SSO

### 인증 방식 비교

<ComparisonTable
  title="Claude Code 인증 방식"
  headers={['방식', '대상', '관리 용이성']}
  rows={[
    { feature: 'Claude for Enterprise', values: ['대규모 조직', 'SSO, 중앙 관리, 감사 로그'] },
    { feature: 'Claude for Teams', values: ['소규모 팀', '팀 관리, 사용량 추적'] },
    { feature: 'Console API Key', values: ['개발팀', 'API 기반, 종량제'] },
    { feature: 'AWS Bedrock', values: ['AWS 사용 조직', 'IAM 기반 인증, VPC 내 통신'] },
    { feature: 'Google Vertex AI', values: ['GCP 사용 조직', 'GCP IAM, 서비스 계정'] },
    { feature: 'Azure Foundry', values: ['Azure 사용 조직', 'Azure AD 연동'] },
  ]}
/>

### SSO 강제 설정

특정 조직의 SSO를 강제하려면 Managed Settings에 다음을 추가합니다:

<CodeBlock
  code={`{
  "forceLoginMethod": "claudeai",
  "forceLoginOrgUUID": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
}`}
  language="json"
  filename="SSO 강제 설정"
/>

Enterprise 플랜에서는 **SAML 2.0** 및 **OIDC** 기반 SSO를 지원합니다. Okta, Azure AD, Auth0 등 주요 IdP와 연동됩니다.

### API 키 동적 관리

API 키를 환경 변수에 하드코딩하는 대신, **apiKeyHelper**로 임시 키를 동적으로 생성할 수 있습니다.

<CodeBlock
  code={`{
  "apiKeyHelper": "/opt/company/bin/generate_temp_api_key.sh"
}

# 스크립트는 stdout으로 API 키를 출력
# 기본 5분마다 또는 HTTP 401 응답 시 자동 재호출
# 갱신 주기 커스텀:
# export CLAUDE_CODE_API_KEY_HELPER_TTL_MS=3600000  (1시간)`}
  language="bash"
  filename="apiKeyHelper 설정"
/>

## 네트워크 및 프록시 설정

기업 네트워크에서는 프록시 서버와 인증서 설정이 필요한 경우가 많습니다.

<CodeBlock
  code={`# HTTP 프록시 설정
export HTTP_PROXY=http://proxy.company.com:8080
export HTTPS_PROXY=https://proxy.company.com:8443
export NO_PROXY=localhost,127.0.0.1,internal.company.com

# 클라이언트 인증서 (mTLS) 설정
export CLAUDE_CODE_CLIENT_CERT=/path/to/client-cert.pem
export CLAUDE_CODE_CLIENT_KEY=/path/to/client-key.pem
export CLAUDE_CODE_CLIENT_KEY_PASSPHRASE=your-passphrase

# 프록시에서 호스트 해석 (DNS 프록시 사용 시)
export CLAUDE_CODE_PROXY_RESOLVES_HOSTS=true`}
  language="bash"
  filename="네트워크/프록시 환경 변수"
/>

## 샌드박스 — 명령어 실행 격리

Claude Code의 **샌드박스** 기능은 Bash 명령어 실행을 격리된 환경에서 수행하여, 파일 시스템과 네트워크 접근을 제한합니다.

### OS별 샌드박스 구현

<ComparisonTable
  title="OS별 샌드박스 기술"
  headers={['OS', '사용 기술', '설치']}
  rows={[
    { feature: 'macOS', values: ['Seatbelt (sandbox-exec)', '내장 (추가 설치 불필요)'] },
    { feature: 'Linux / WSL2', values: ['bubblewrap (bwrap)', 'sudo apt-get install bubblewrap socat'] },
    { feature: 'WSL1', values: ['미지원', '-'] },
  ]}
/>

### 샌드박스 설정

<CodeBlock
  code={`{
  "sandbox": {
    "enabled": true,
    "autoAllowBashIfSandboxed": true,
    "excludedCommands": ["docker", "git"],
    "allowUnsandboxedCommands": false,
    "network": {
      "allowedDomains": [
        "github.com",
        "*.npmjs.org",
        "registry.yarnpkg.com"
      ],
      "allowUnixSockets": ["~/.ssh/agent-socket"],
      "allowAllUnixSockets": false,
      "allowLocalBinding": true,
      "httpProxyPort": 8080,
      "socksProxyPort": 8081
    }
  }
}`}
  language="json"
  filename="샌드박스 설정 예시"
/>

<Callout type="warning" title="샌드박스 네트워크 주의사항">
  `allowedDomains`에 넓은 범위의 도메인(예: `*.github.com`)을 허용하면 데이터 유출 경로가 될 수 있습니다.
  `allowAllUnixSockets: true`는 Docker 소켓을 통한 호스트 접근이 가능해지므로 반드시 false로 유지하세요.
</Callout>

### DevContainer 격리

더 강력한 격리가 필요한 경우 DevContainer를 사용할 수 있습니다. Anthropic은 공식 DevContainer 레퍼런스 구현을 제공합니다.

<CodeBlock
  code={`# DevContainer 레퍼런스:
# https://github.com/anthropics/claude-code/tree/main/.devcontainer

# .devcontainer/devcontainer.json 에서
# Claude Code 실행 환경을 완전히 격리된 컨테이너로 구성 가능`}
  language="bash"
  filename="DevContainer 참조"
/>

## 감사 로깅 — OpenTelemetry

Claude Code는 **OpenTelemetry(OTel)** 표준을 지원하여 사용 메트릭과 이벤트를 수집할 수 있습니다. Datadog, Grafana, Splunk 등 기존 모니터링 인프라와 연동됩니다.

### OTel 설정

<CodeBlock
  code={`{
  "env": {
    "CLAUDE_CODE_ENABLE_TELEMETRY": "1",
    "OTEL_METRICS_EXPORTER": "otlp",
    "OTEL_LOGS_EXPORTER": "otlp",
    "OTEL_EXPORTER_OTLP_PROTOCOL": "grpc",
    "OTEL_EXPORTER_OTLP_ENDPOINT": "http://collector.company.com:4317",
    "OTEL_EXPORTER_OTLP_HEADERS": "Authorization=Bearer your-token"
  }
}`}
  language="json"
  filename="managed-settings.json 에 OTel 설정"
/>

<Callout type="info" title="텔레메트리 vs OTel">
  `DISABLE_TELEMETRY=1`은 Anthropic으로의 Statsig 사용 통계 전송을 차단합니다.
  `CLAUDE_CODE_ENABLE_TELEMETRY=1`은 **회사 내부 OTel 수집기**로의 메트릭 전송을 활성화합니다.
  두 설정은 독립적이며, 일반적으로 Anthropic 텔레메트리는 끄고 내부 OTel은 켜는 것이 엔터프라이즈 권장 구성입니다.
</Callout>

### 수집 가능한 메트릭

<ComparisonTable
  title="주요 OTel 메트릭"
  headers={['메트릭', '설명', '활용']}
  rows={[
    { feature: 'claude_code.session.count', values: ['세션 시작 횟수', '사용량 추적'] },
    { feature: 'claude_code.lines_of_code.count', values: ['수정된 코드 줄 수', '생산성 측정'] },
    { feature: 'claude_code.pull_request.count', values: ['PR 생성 횟수', '워크플로우 분석'] },
    { feature: 'claude_code.commit.count', values: ['커밋 생성 횟수', '활동량 추적'] },
    { feature: 'claude_code.cost.usage', values: ['비용 (USD)', '예산 관리'] },
    { feature: 'claude_code.token.usage', values: ['토큰 사용량', '사용량 모니터링'] },
    { feature: 'claude_code.active_time.total', values: ['활성 사용 시간', '효율성 분석'] },
  ]}
/>

### 수집 가능한 이벤트

<ComparisonTable
  title="주요 OTel 이벤트"
  headers={['이벤트', '설명', '주요 속성']}
  rows={[
    { feature: 'claude_code.user_prompt', values: ['사용자 프롬프트', 'prompt_length, prompt (기본 비활성)'] },
    { feature: 'claude_code.tool_result', values: ['도구 실행 결과', 'tool_name, success, duration_ms'] },
    { feature: 'claude_code.api_request', values: ['API 요청', 'model, cost_usd, tokens'] },
    { feature: 'claude_code.api_error', values: ['API 에러', 'error, status_code'] },
    { feature: 'claude_code.tool_decision', values: ['도구 권한 결정', 'tool_name, decision, source'] },
  ]}
/>

### 사용자 프롬프트 로깅

기본적으로 프롬프트 내용은 수집되지 않습니다. 컴플라이언스 요구사항에 따라 활성화할 수 있습니다:

<CodeBlock
  code={`# 프롬프트 내용까지 OTel로 전송 (기본 비활성)
export OTEL_LOG_USER_PROMPTS=1`}
  language="bash"
  filename="프롬프트 로깅 활성화"
/>

### 팀별 세분화

<CodeBlock
  code={`# OTel 리소스 속성으로 팀/부서별 분류
export OTEL_RESOURCE_ATTRIBUTES="department=engineering,team.id=platform,cost_center=eng-123"`}
  language="bash"
  filename="팀별 OTel 속성"
/>

### 동적 OTel 헤더

인증 토큰이 만료되는 경우, 헬퍼 스크립트로 자동 갱신할 수 있습니다:

<CodeBlock
  code={`{
  "otelHeadersHelper": "/opt/company/bin/generate_otel_headers.sh"
}

# 기본 29분마다 갱신
# 커스텀 갱신 주기:
# export CLAUDE_CODE_OTEL_HEADERS_HELPER_DEBOUNCE_MS=900000`}
  language="bash"
  filename="OTel 헤더 동적 갱신"
/>

## Hook 관리

Hook은 Claude Code의 특정 이벤트에 자동으로 실행되는 스크립트입니다. 엔터프라이즈에서는 승인된 Hook만 실행되도록 제한할 수 있습니다.

<CodeBlock
  code={`{
  "allowManagedHooksOnly": true,
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "/opt/company/hooks/validate-bash-command.sh"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Edit",
        "hooks": [
          {
            "type": "command",
            "command": "/opt/company/hooks/audit-file-edit.sh"
          }
        ]
      }
    ]
  }
}`}
  language="json"
  filename="Hook 관리 설정"
/>

<Callout type="important" title="allowManagedHooksOnly">
  `allowManagedHooksOnly: true`로 설정하면 개발자가 개인 Hook을 추가할 수 없습니다.
  Managed Settings에 정의된 Hook만 실행됩니다.
</Callout>

## 마켓플레이스 제한

Claude Code의 플러그인/MCP 서버 설치를 승인된 소스로만 제한할 수 있습니다.

<CodeBlock
  code={`{
  "strictKnownMarketplaces": [
    { "source": "github", "repo": "company-org/approved-plugins", "ref": "v2.0" },
    { "source": "git", "url": "https://gitlab.company.com/tools/plugins.git" },
    { "source": "npm", "package": "@company/compliance-plugins" },
    { "source": "url", "url": "https://plugins.company.com/marketplace.json" },
    { "source": "file", "path": "/usr/local/share/claude/marketplace.json" },
    { "source": "directory", "path": "/usr/local/share/claude/plugins" },
    { "source": "hostPattern", "hostPattern": "^github\\\\.company\\\\.com$" }
  ]
}`}
  language="json"
  filename="마켓플레이스 제한 설정"
/>

## 컴플라이언스 인증

Anthropic은 다음과 같은 보안 인증을 보유하고 있습니다:

<ComparisonTable
  title="보안 인증 현황"
  headers={['인증', '상태', '설명']}
  rows={[
    { feature: 'SOC 2 Type 2', values: ['yes', '보안, 가용성, 처리 무결성, 기밀성, 개인정보 보호'] },
    { feature: 'ISO 27001:2022', values: ['yes', '정보보안 관리 체계'] },
    { feature: 'ISO/IEC 42001:2023', values: ['yes', 'AI 관리 시스템'] },
    { feature: 'HIPAA', values: ['BAA 제공 (Enterprise/API)', 'Enterprise 및 API 고객 대상 BAA 체결 가능'] },
    { feature: '전송 암호화', values: ['TLS', '모든 API 통신 암호화'] },
    { feature: '저장 암호화', values: ['AES-256', '저장 데이터'] },
  ]}
/>

<Callout type="tip" title="Trust Center">
  Anthropic의 보안 인증, 정책, 컴플라이언스 정보는 trust.anthropic.com에서 확인할 수 있습니다.
</Callout>

## 엔터프라이즈 배포 체크리스트

실무에서 Claude Code를 조직에 배포할 때 참고할 체크리스트입니다.

<CodeBlock
  code={`# ✅ 1단계: 계정 및 인증
- [ ] Enterprise/Team 플랜 또는 API 계정 확인 (학습 데이터 사용 안 됨)
- [ ] SSO 구성 (forceLoginMethod, forceLoginOrgUUID)
- [ ] API 키 관리 방식 결정 (apiKeyHelper 또는 클라우드 IAM)

# ✅ 2단계: Managed Settings 배포
- [ ] managed-settings.json 작성
- [ ] MDM/GPO/Ansible 등으로 전체 배포
- [ ] disableBypassPermissionsMode: "disable" 설정
- [ ] allowManagedHooksOnly: true 설정

# ✅ 3단계: 텔레메트리 정책
- [ ] Anthropic 텔레메트리 비활성화 (CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)
- [ ] 내부 OTel 수집기 구성 (CLAUDE_CODE_ENABLE_TELEMETRY)

# ✅ 4단계: 권한 정책
- [ ] deny 규칙: .env, secrets, sudo, curl/wget 차단
- [ ] allow 규칙: 빌드, 테스트, 린트 등 승인
- [ ] MCP 서버 허용/차단 목록 설정

# ✅ 5단계: 네트워크
- [ ] 프록시 설정 (HTTP_PROXY, HTTPS_PROXY)
- [ ] 클라이언트 인증서 구성 (mTLS 환경)
- [ ] 샌드박스 네트워크 제한 (allowedDomains)

# ✅ 6단계: 감사 및 모니터링
- [ ] OTel 메트릭/이벤트 수집 구성
- [ ] 팀별 리소스 속성 설정
- [ ] 대시보드 구성 (비용, 사용량, 활동)`}
  language="markdown"
  filename="엔터프라이즈 배포 체크리스트"
/>

## 핵심 환경 변수 요약

<CodeBlock
  code={`# === 프라이버시 ===
CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC=1  # Anthropic 텔레메트리 전체 차단

# === 인증 ===
ANTHROPIC_API_KEY=<key>                      # API 키 (직접 사용)
CLAUDE_CODE_USE_BEDROCK=true                 # AWS Bedrock 사용
CLAUDE_CODE_USE_VERTEX=true                  # Google Vertex 사용

# === 네트워크 ===
HTTP_PROXY=http://proxy.company.com:8080
HTTPS_PROXY=https://proxy.company.com:8443
NO_PROXY=localhost,127.0.0.1
CLAUDE_CODE_CLIENT_CERT=/path/to/cert.pem
CLAUDE_CODE_CLIENT_KEY=/path/to/key.pem

# === 내부 모니터링 (OTel) ===
CLAUDE_CODE_ENABLE_TELEMETRY=1
OTEL_METRICS_EXPORTER=otlp
OTEL_LOGS_EXPORTER=otlp
OTEL_EXPORTER_OTLP_ENDPOINT=http://collector:4317

# === 기타 제어 ===
CLAUDE_CODE_DISABLE_BACKGROUND_TASKS=1       # 백그라운드 작업 비활성화
CLAUDE_CODE_HIDE_ACCOUNT_INFO=1              # 계정 정보 숨김`}
  language="bash"
  filename="엔터프라이즈 핵심 환경 변수"
/>

<ChapterNav
  prev={{ title: 'CLAUDE.md 딥다이브', path: '/docs/part-1--기초-claude-md-딥다이브' }}
  next={{ title: '프롬프트 엔지니어링', path: '/docs/part-1--기초-프롬프트-엔지니어링' }}
/>
